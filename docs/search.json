[
  {
    "objectID": "ALADYM_tuning_tutorial.html",
    "href": "ALADYM_tuning_tutorial.html",
    "title": "ALADYM_tuning_tutorial",
    "section": "",
    "text": "COISPA Website    COISPA Github"
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#input-data-requirements",
    "href": "ALADYM_tuning_tutorial.html#input-data-requirements",
    "title": "ALADYM_tuning_tutorial",
    "section": "Input data requirements",
    "text": "Input data requirements\nAfter installation of the ALADYM tuning software, a baseline ALADYM configuration must be prepared. This baseline configuration is the structural reference from which all tuning combinations are generated. Every Tr–Fbar configuration produced by the tuning scripts is a direct modification of this baseline.\nSeveral constraints are critical.\nNatural mortality (M) files must start at age 0. Any offset in age indexing will cause misalignment between biological processes and assessment data, leading to error calculations.\nMissing values in all configuration files must be encoded as NAN, not NA. ALADYM is not NA-aware. Using NA leads to type coercion, failed reads, or numerical propagation of missing values - NAN is explicitly handled by the model and by the tuning scripts.\nThe ALADYM configuration file used here is not the same as the BEMTOOL configuration file. BEMTOOL wraps ALADYM but applies additional preprocessing and abstractions. The tuning workflow operates directly on ALADYM inputs. A template ALADYM configuration file adapted for tuning is provided  here. \n\n\n\n  \n\n\n\nExample ALADYM configuration file.\n\n\nFinally, the simulation period defined in the configuration must match exactly the years available in the assessment time series used for calibration. No extrapolation or truncation is performed automatically."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#generation-of-trfbar-combinations",
    "href": "ALADYM_tuning_tutorial.html#generation-of-trfbar-combinations",
    "title": "ALADYM_tuning_tutorial",
    "section": "Generation of Tr–Fbar combinations",
    "text": "Generation of Tr–Fbar combinations\nTr–Fbar tuning is based on a grid search approach. The parameter space is discretised into a finite set of Tr values and Fbar age ranges, and ALADYM is run once for each possible combination.\nThe generation of parameter combinations is handled by the script:\nALADYM_tuning_main_config.R\nThis script reconstructs all mortality-related inputs so that each ALADYM run is internally consistent with the selected Tr–Fbar combination. In practice, the script performs the following operations.\nIt first reads a baseline ALADYM configuration file located in C:\\INPUT\\ALADYM. The script then defines the vectors of Tr values and Fbar age ranges to be explored and builds the full Cartesian product of these parameters.\nFor each Tr–Fbar combination, the script automatically generates three classes of files:\n\nM files, truncated or shifted so that natural mortality starts at the specified Tr value.\nZ files, recalculated to reflect both the selected age-grouping criterion for Fbar and the current Tr value.\nALADYM configuration files, updated so that they reference the correct M and Z files associated with that specific combination.\n\nAll generated configuration files differ from the baseline only in the Tr definition, the Fbar age range, and the mortality file paths. Every other parameter and model setting is inherited unchanged from the baseline configuration.\nNote, the script assumes the following directory structure and requirements:\n\nThe original baseline ALADYM configuration file must be located in C:\\INPUT\\ALADYM.\nSpecies-specific M and F input files must be stored in C:\\INPUT\\ALADYM\\species_folder.\n\nIf fishing mortality at age files are not available, the parameters F_at_age_F and F_at_age_M must be set to “None” in the baseline configuration. In this case, an Fbar_assessment file must be provided. All Z values will then be computed internally from the Fbar assessment data for each Tr–Fbar combination. This can be seen in the following example code.\n## paths\n# input path - main folder where we can find M, F and config_file\nip &lt;- \"C:\\\\INPUT\\\\ALADYM\"\n\n# output path - where you want to save the output (usually C:\\INPUT\\ALADYM)\nop &lt;- \"C:\\\\INPUT\\\\ALADYM\"\n\n# species folder - used for M and F files\nspecies_folder &lt;- \"MUT1718\"\n\n\n# are there different M files for males and females?\nM_different &lt;- TRUE\n\n\n## set the M files names -&gt; make sure these start from age = 0 \n# sex-specific files?\nM_male &lt;- \"M_MUT_M.csv\"\nM_female &lt;- \"M_MUT_F.csv\"\n\n# instead, if they have the same file:\nM_file &lt;- \"M_MUT.csv\"\n\n\n## if F_at_age files exist\nF_at_age_M &lt;- \"F_at_age_MUT_M.csv\"\nF_at_age_F &lt;- \"F_at_age_MUT_F.csv\"\nFbar_assessment &lt;- \"None\"\n\n# otherwise, if there is only an Fbar file coming from the assessment\n# F_at_age_M &lt;- \"None\"\n# F_at_age_F &lt;- \"None\n# Fbar_assessment &lt;- \"Fbar_assessment_MUT.csv\"\n\n## set initial configuration file -&gt; must live in C:\\INPUT\\ALADYM\n## make sure that NA values are specified as NAN (needed for the splitting)\nconfiguration &lt;- \"aladym_MUT_GSA17_18.csv\"\n\n## set tr\ntr = c(0, 1, 2, 3)\n\n## set F_range over which to calculate Fbar, eg: list(c(0,3),c(1,4))\n# if you only have Fbar from assessment, set F_range = None\n\nF_range = list(c(0,1),c(2,3),c(4,5))\n# F_range = \"None\"\n\n\n## time series\nts = c(2004:2024)\n\n## species\nspe = 'MUT'\n\n\nExample of input paths for the creation of different ALADYM configuration files.\n\n\nAll generated files are written automatically to C:\\INPUT\\ALADYM. The naming convention encodes the Tr value and the Fbar age range directly in the filename, allowing each simulation to be uniquely identified and unambiguously traced back to its parameter values.\nTwo examples of the naming convention are as follows:\n\nconfig_run_0_1-3.csv means the configuration file considers tr = 0 and Fbar = (1-3);\nconfig_run_0_assess.csv means the configuration file considers tr = 0 and uses the Fbar range used in the assessment.\n\nOnce ALADYM_tuning_main_config.R has completed execution, no further manual editing of M files, Z files, or configuration files is required."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#running-the-trfbar-tuning",
    "href": "ALADYM_tuning_tutorial.html#running-the-trfbar-tuning",
    "title": "ALADYM_tuning_tutorial",
    "section": "Running the Tr–Fbar tuning",
    "text": "Running the Tr–Fbar tuning\nOnce all Tr–Fbar configuration files have been generated, the tuning phase is launched by clicking on the source button in the file\nALADYM_tuning.R.\nThis script operates the full calibration workflow. It iterates sequentially over all Tr–Fbar configuration files created in the previous step by launching ALADYM in batch mode for each configuration without requiring user interaction.\nFor every Tr–Fbar combination, the script extracts annual time series of spawning stock biomass (SSB), Fbar, and total catch from the ALADYM outputs, which are then compared against the corresponding assessment data. Relative errors are computed, and a scalar score is calculated for each combination as the sum of mean squared relative errors across all indicators (see next section)."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#outputs-and-diagnostics",
    "href": "ALADYM_tuning_tutorial.html#outputs-and-diagnostics",
    "title": "ALADYM_tuning_tutorial",
    "section": "Outputs and diagnostics",
    "text": "Outputs and diagnostics\nThe calibration score is defined as the sum of mean squared relative errors between simulated and assessment time series for SSB, Fbar, and total catch. For each indicator \\(X\\), the relative error is computed as\n\\[\nErr_t = \\frac{X_t^{sim} - X_t^{obs}}{X_t^{sim}},\n\\] and the total score is\n\\[\nScore = \\frac{1}{T} \\sum_{t=1}^T (Err_t^{SSB})^2 + \\frac{1}{T} \\sum_{t=1}^T (Err_t^{Fbar})^2 + \\frac{1}{T} \\sum_{t=1}^T (Err_t^{Catch})^2.\n\\] The use of squared relative errors ensures scale-independence across indicators with different magnitudes and penalises large deviations more strongly than small ones.\nAll results are accumulated into a single calibration table that links each Tr–Fbar combination to its diagnostic metrics and overall score, found in the Combo_runs_diagnostics folder.\n\n\n\n\nFigure 2 - Calibration table.\n\nIn parallel, the script creates a dedicated output folder for each parameter combination. Each folder contains the full set of diagnostic plots and intermediate results associated with that specific run, allowing post hoc inspection of individual simulations.\nAt the end of the tuning process, the script identifies the Tr–Fbar combination with the lowest total score. This best-performing configuration is recorded in a plain text file that reports the selected Tr value, Fbar age range, and associated score. In addition, two summary output directories are produced: one containing the diagnostics for all tested combinations, and a second containing only the diagnostics associated with the best-performing configuration.\n\n\n\n\nFigure 3 - Example of folders and files created after ALADYM tuning is complete.\n\nAll output folders and files generated by ALADYM_tuning.R are written to the same directory in which the tuning script lives. No automatic cleanup is performed. To maintain an organised project structure, it is recommended to manually create a species-specific folder and move all tuning outputs into that location once the procedure has completed, as shown below:\n\n\n\n\nFigure 4 - Example of species-specific folders to cleanup the repository."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#input-data-requirements-1",
    "href": "ALADYM_tuning_tutorial.html#input-data-requirements-1",
    "title": "ALADYM_tuning_tutorial",
    "section": "Input data requirements",
    "text": "Input data requirements\nSelectivity is defined at the fleet-segment level. Each fleet is associated with:\n\na selectivity type identifier,\na fixed number of parameter slots (six in the input file),\na subset of those parameters actually used, depending on the selectivity type.\n\nThe selectivity input file is rectangular by design: all fleets share the same column structure, even if some parameters are unused. Unused parameters must still be present and must be left empty."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#definition-of-parameter-ranges",
    "href": "ALADYM_tuning_tutorial.html#definition-of-parameter-ranges",
    "title": "ALADYM_tuning_tutorial",
    "section": "Definition of parameter ranges",
    "text": "Definition of parameter ranges\nSelectivity tuning is driven by user-defined parameter ranges. For each parameter involved in a given selectivity type, a discrete set of candidate values is specified.\nThese ranges are defined in R as simple numeric vectors. The tuning scripts do not assume continuity or bounds; they only enumerate combinations.\nOnly parameters that are active for a given selectivity type are included in the combination space. The remaining parameter slots are left unchanged from the baseline configuration."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#generation-of-selectivity-configurations",
    "href": "ALADYM_tuning_tutorial.html#generation-of-selectivity-configurations",
    "title": "ALADYM_tuning_tutorial",
    "section": "Generation of selectivity configurations",
    "text": "Generation of selectivity configurations\nConfiguration generation is handled by the selectivity tuning scripts. Internally, the process follows three steps:\n\nThe selectivity file is split by fleet segment.\nFor each fleet, all valid parameter combinations are generated using a Cartesian product over the active parameters.\nFull-model configurations are created by combining fleet-level parameter choices across fleets.\n\nThe result is a set of complete ALADYM configurations, each corresponding to one unique multi-fleet selectivity setup. Each configuration modifies only the selectivity file; all other inputs remain identical to the optimal Tr–Fbar baseline.\nConfiguration folders are named systematically to encode the selectivity parameter combination. This naming is later used to aggregate results and compute scores."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#running-selectivity-tuning",
    "href": "ALADYM_tuning_tutorial.html#running-selectivity-tuning",
    "title": "ALADYM_tuning_tutorial",
    "section": "Running selectivity tuning",
    "text": "Running selectivity tuning\nOnce configuration files are generated, the selectivity tuning run is launched in batch mode. For each configuration, ALADYM is executed and the following outputs are extracted:\n\nstock-level indicators (SSB, Fbar, total catch),\nfleet-specific annual catches.\n\nRelative errors are computed both at the stock level and at the fleet level. Fleet errors are retained explicitly rather than collapsed immediately, allowing inspection of trade-offs between fleets.\nA global score is computed by combining stock-level errors with fleet-level error summaries. The weighting scheme is transparent and can be modified if required."
  },
  {
    "objectID": "ALADYM_tuning_tutorial.html#outputs-and-diagnostics-1",
    "href": "ALADYM_tuning_tutorial.html#outputs-and-diagnostics-1",
    "title": "ALADYM_tuning_tutorial",
    "section": "Outputs and diagnostics",
    "text": "Outputs and diagnostics\nSelectivity tuning produces:\n\na comprehensive error table with one row per configuration,\nfleet-specific error metrics,\ndiagnostic plots showing simulated versus observed catches for each fleet,\naggregated plots showing all selectivity simulations against observations.\n\nThe best-performing configuration is identified based on the defined score criterion, but alternative near-optimal solutions can be inspected to evaluate robustness and fleet trade-offs."
  }
]